import{r as i,u as w,g as A,o as R,c as U,a,b as l,e as z,w as I,v as G,h as W,F as L}from"./index-17b39a37.js";import{E as M}from"./jspdf.plugin.autotable-9cc3a30b.js";import{u as V}from"./program-4a6da989.js";import{l as k,a as B}from"./logo-fcs-f9e43ec2.js";function Y(){const d=new Date;let r=d.getDate(),c=d.getMonth()+1,m=d.getFullYear();return r<10&&(r="0"+r),c<10&&(c="0"+c),{currentDate:i(r+"-"+c+"-"+m)}}const j=a("div",{class:"row"},[a("div",{class:"col d-flex align-items-center page-bar"},[a("span",{class:"page-title"},"Reporte de pagos")])],-1),H={class:"row"},X={class:"col mt-3 mb-3"},J={class:"card shadow-sm top-random"},$={class:"card-header d-flex justify-content-between text-random"},q=a("span",{class:"h6"},"CONCEPTOS DE PAGO",-1),K=a("span",{class:"fa-solid fa-print"},null,-1),Q={class:"card-body"},Z={class:"row"},ee=a("div",{class:"col-auto"},[a("span",{class:"form-label fw-bold text-secondary"},"Buscar:")],-1),te={class:"col"},re={__name:"PaymentView",setup(d){const r="https://usefcs.unsm.edu.pe/api",c=JSON.parse(localStorage.getItem("use")),m=localStorage.getItem("student"),{personName:u,personDocument:y}=w(r,c),{programName:P}=V(r,c,m),{currentDate:S}=Y();let h=i([]),v=i([]),g=i(0),f=i(0);(async()=>{let e=await(await fetch(r+"/intranet/student-payment",{headers:{"X-Accesss-Token":c,"X-Student-Id":m}})).json();h.value=e,v.value=e.map((t,s)=>[s+1,t.concept,t.amount,t.process,t.type]),g.value=e.filter(t=>t.type==="Pagado").reduce((t,s)=>t+Number(s.amount),0),f.value=e.filter(t=>t.type==="Pendiente").reduce((t,s)=>t+Number(s.amount),0)})();const F=["concept","amount","process","type"],p=i(""),D=i([{text:"CONCEPTO",value:"concept"},{text:"MONTO",value:"amount"},{text:"PERIODO",value:"process"},{text:"ESTADO",value:"type"}]);let O="Universidad Nacional de San Martín",E="Facultad de Ciencias de la Salud",N="Unidad de Segunda Especialidad";const _=k,C=B;let b=o=>{const e=new M;let t=e.internal.pageSize.getWidth();e.addImage(_,"PNG",10,10,24,24),e.setFontSize(16),e.setFont("helvetica","normal"),e.text(O.toUpperCase(),t/2,16,"center"),e.setFontSize(13),e.setFont("helvetica","normal"),e.text(E.toUpperCase(),t/2,23,"center"),e.setFontSize(15),e.setFont("helvetica","normal"),e.text(N.toUpperCase(),t/2,31,"center"),e.addImage(C,"PNG",175,10,24,24);const s=e.internal.getNumberOfPages();e.setFontSize(19),e.setFont("helvetica","bold"),e.text("REPORTE DE CONCEPTOS DE PAGO",t/2,42,"center"),e.setLineWidth(.3),e.line(10,44,200,44),e.setFontSize(10),e.setFont("helvetica","bold"),e.text("PROGRAMA",10,51),e.text(":",34,51),e.setFont("helvetica","normal");let T=e.splitTextToSize(o.programName.toUpperCase(),162);e.text(T,37,51),e.setFont("helvetica","bold"),e.text("ESTUDIANTE",10,61),e.text(":",34,61),e.setFont("helvetica","normal"),e.text(o.personName.toUpperCase(),37,61),e.setFont("helvetica","bold"),e.text("CÓDIGO/DNI",10,66),e.text(":",34,66),e.setFont("helvetica","normal"),e.text(o.personDocument,37,66),e.setTextColor(222,222,222),e.setFont("helvetica","bold"),e.setFontSize(100),e.text("SOLO",60,160,{angle:45}),e.text("LECTURA",60,200,{angle:45}),e.setTextColor(0,0,0),e.setFont("helvetica","bold"),e.setFontSize(10),e.text("PAGADO",10,76),e.text(":",28,76),e.setFont("helvetica","normal"),e.text("S/ "+o.totalPaymentsPayed,31,76),e.setFont("helvetica","bold"),e.text("PENDIENTE",80,76),e.text(":",102,76),e.setFont("helvetica","normal"),e.text("S/ "+o.totalPaymentsPendant,105,76),e.setFont("helvetica","bold"),e.text("FECHA",164,76),e.text(":",178,76),e.setFont("helvetica","normal"),e.text(o.currentDate,181,76);let x=79;e.autoTable({margin:[28,10],theme:"plain",didDrawCell:function(n){e.rect(n.cell.x,n.cell.y,n.cell.width,n.cell.height)},styles:{fontSize:7,font:"helvetica",fontStyle:"normal"},headStyles:{font:"helvetica",fontStyle:"bold",fillColor:"#000000",textColor:"#ffffff"},columnStyles:{0:{cellWidth:8},1:{cellWidth:132},2:{cellWidth:18},3:{cellWidth:16},4:{cellWidth:16}},startY:x,columns:["#","CONCEPTO","MONTO","PERIODO","ESTADO"],body:o.paymentsListPdf}),x=e.lastAutoTable.finalY+5,e.setTextColor(0,0,0),e.setFont("helvetica","normal"),e.setFontSize(8);for(let n=1;n<=s;n++)e.setPage(n),e.text("Pag "+String(n)+" de "+String(s),197,287,{align:"right"});e.save("REPORTE DE PAGOS - "+Date()+".pdf")};return(o,e)=>{const t=A("EasyDataTable");return R(),U(L,null,[j,a("div",H,[a("div",X,[a("div",J,[a("div",$,[q,a("span",{class:"cursor-pt",onClick:e[0]||(e[0]=s=>l(b)({programName:l(P),personName:l(u),personDocument:l(y),paymentsListPdf:l(v),totalPaymentsPayed:String(l(g)),totalPaymentsPendant:String(l(f)),currentDate:l(S)}))},[K,z(" DESCARGAR ")])]),a("div",Q,[a("div",Z,[ee,a("div",te,[I(a("input",{type:"text",class:"form-control form-control-sm mb-2","onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s)},null,512),[[G,p.value]])])]),W(t,{headers:D.value,items:l(h),"search-field":F,"search-value":p.value,"rows-per-page":10,"show-index":"",alternating:"","buttons-pagination":""},null,8,["headers","items","search-value"])])])])])],64)}}};export{re as default};
